<!DOCTYPE html>
<html lang="zh">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <title>编辑网页内容</title>

        <meta name="renderer" content="webkit|ie-comp|ie-stand" />

        <link rel="stylesheet" href="asset/bootstrap-3.3.7/css/bootstrap.min.css"/>
        <link rel="stylesheet" href="asset/bootstrap-3.3.7/css/bootstrap-theme.min.css"/>

        <link rel="stylesheet" href="style/common_style_classes/common_style_classes.css"/>
        <link rel="stylesheet" href="style/common_style_classes/common_component.css"/>

        <style>

            body { font-size: 16px; }
            .page { height: 100%; }
            .pageHeader {
                position: absolute;
                z-index: 1;
                width: 100%;
                height: 120px;
                box-sizing: border-box;
                background-color: #efefef;
                border-bottom: solid 1px #d9d9d9;
            }

            .content {
                box-sizing: border-box;
                padding-top: 120px;
                height: 100%;
                background-color: #FFF;
            }

            .content .inner { height: 100%; }

            .sidebar {
                box-sizing: border-box;
                height: 100%;
                border-right: solid 1px #d9d9d9;
            }

            .toolWindow {
                background-color: #FFF;
            }

            .toolWindow .title, #viewArea .title {
                padding: 4px;
                font-size: 120%;
                /*border-bottom: solid 1px #d9d9d9;*/
            }

            #structureToolWindow .tagNode .childrenContainer {
                padding-left: 2ex;
            }

        #viewArea .viewAreaContent {
            background-color: #FFF;
            border: solid 3px #dedede;
            padding: 10px;
            box-sizing: border-box;
        }
        </style>

    </head>
    <body class="fullHeight">

        <div class="page">

            <header class="header pageHeader">
                <h1>编辑网页内容</h1>
                <div id="toolbar">
                    <label class="inline">选择控件：</label>
                    <select id="controlSelectbox" class="form-control">
                        <option value="inputboxGroup">文本输入组</option>
                    </select>
                    <button class="btn btn-default" id="insertControl">插入控件</button>
                    <button class="btn btn-default" id="deleteControl">删除控件</button>
                </div>
            </header>

            <div class="content container-fluid">

                <div class="inner row">

                    <!-- sidebar -->
                    <div class="sidebar col-xs-12 col-sm-6 col-md-3 col-lg-2">

                        <!-- structure module -->
                        <div id="structureToolWindow" class="toolWindow">

                            <div class="title">结构</div>

                            <div class="htmlTagTreeView">
                                <div class="tagNode extended">
                                    <div class="name tagName">form</div>
                                    <div class="childrenContainer">
                                        <div class="tagNode">
                                            <div class="name tagName">text 控件组</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                    </div>

                    <div class="mainContent col-xs-12 col-sm-6 col-md-8 col-lg-10">

                        <div id="viewArea">

                            <div class="title">预览</div>

                            <div class="viewAreaContent">

                                <form action="action.jsp" method="post">
                                    <div class="form-group">
                                        <label class="block" for="usernameInputbox">用户名：</label>
                                        <div>
                                            <input type="text" id="usernameInputbox" class="form-control"
                                                   name="username" />
                                        </div>
                                    </div>
                                </form>

                            </div>

                        </div>

                    </div>

                </div>
            </div>
        </div>

        <script src="script/common_script/common_function.js"></script>

        <script src="asset/jquery/jquery-3.1.0.min.js"></script>

        <script src="asset/moment-with-locales.min.js"></script>
        <script src="asset/bootstrap-3.3.7/js/bootstrap.min.js"></script>

        <!-- app config -->
        <script src="js/appConfig.js"></script>
        <script src="js/errorMessageList.js"></script>

        <!-- common action (it must after jQuery) -->
        <script src="script/common_script/common_action.js"></script>

    <script>
        var editHtmlContentUtil = {

            // data element : {
            //   xtype : a | img | span | form | inputboxGroup
            //   other html tag attributes...
            //   children : []
            // }
            data : [{
                xtype : 'form',
                method : "post",
                action : "action.jsp",
                children : [{
                    xtype : 'inputboxGroup',
                    labelTitle : 'username:',
                    id : "usernameInputbox",
                    class : "form-control",
                    name : "username",
                    placeholder : 'please insert your username'
                }]
            }],

            insertDataItem : function(data, index){
                this.data.splice(index, 0, "three");
            },

            removeDataItem : function(index){
                this.data.splice(index, 1);
            },

            /**
             * render structure view for structure tool window
             */
            renderStructure : function(){
                // each data element
                for (var index in this.data)
                {
                    var item = this.createStructureItem(this.data[index]);
                    $('#structureToolWindow .htmlTagTreeView').append(item);
                }
            },

            /**
             * create structure tag item
             * @param data  Object
             * @returns jQuery object
             */
            createStructureItem : function(data){

                // create tag
                var item = $('<div class="tagNode extended">' +
                    '<div class="name tagName">' + data.xtype + '</div>' +
                '</div>');

                // create children
                if (typeof (data.children) != 'undefined')
                {
                    item.append('<div class="childrenContainer"></div>');
                    for (var childrenIndex in data.children)
                    {
                        var childrenItem = this.createStructureItem(data.children[childrenIndex]);
                        item.find('> .childrenContainer').append(childrenItem);
                    }
                }

                return item;
            },

            createPreviewItem : function(data)
            {
                var item = null;
                switch (data.xtype)
                {
                    case 'inputboxGroup' :
                        item = $('<div class="form-group"><label class="block"></label>' +
                            '<input type="text" class="form-control"/></div>');

                        item.find('input').attr(data);
                        if (typeof(data.labelTitle) != 'undefined')
                        {

                        }
                        break;
                    default :
                        item = $('<' + data.xtype + '/>');
                        item.attr(data);
                        if (typeof (data.children) != 'undefined')
                        {
                            for (var childrenIndex in data.children)
                            {
                                item.append(this.createPreviewItem(data.children[childrenIndex]));
                            }
                        }
                        break;
                }
                return item;
            },

            renderPreview : function(){
                // each data element
                for (var index in this.data)
                {
                    var item = this.createPreviewItem(this.data[index]);
                    $('#viewArea .viewAreaContent').append(item);
                }

            },

            updateView : function(){

                $('#structureToolWindow .htmlTagTreeView').html('');
                this.renderStructure();

                $('#viewArea .viewAreaContent').html('');
                this.renderPreview();
            }

        };
    </script>

    </body>
</html>